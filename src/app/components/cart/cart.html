<div class="cart-container">
  <h1>Shopping Cart</h1>

  <div *ngIf="removeMessage" class="alert alert-success">
    {{ removeMessage }}
  </div>

  <div *ngIf="cartItems.length === 0" class="empty-cart">
    <p>Your cart is empty</p>
    <a routerLink="/products" class="btn btn-primary">Continue Shopping</a>
  </div>

  <div *ngIf="cartItems.length > 0" class="cart-content">
    <div class="cart-items">
      <div *ngFor="let item of cartItems" class="cart-item">
        <img [src]="item.product.url" [alt]="item.product.name" class="item-image" />
        <div class="item-info">
          <h3>{{ item.product.name }}</h3>
          <p class="price">${{ item.product.price.toFixed(2) }}</p>
        </div>
        <div class="item-actions">
          <label for="quantity-{{ item.product.id }}">Qty:</label>
          <input
            type="number"
            id="quantity-{{ item.product.id }}"
            [value]="item.quantity"
            (change)="updateQuantity(item.product.id, $event)"
            min="1"
            class="quantity-input"
          />
          <p class="subtotal">Subtotal: ${{ (item.product.price * item.quantity).toFixed(2) }}</p>
          <button class="btn btn-danger" (click)="removeItem(item.product.id)">Remove</button>
        </div>
      </div>
    </div>

    <div class="checkout-section">
      <div class="total">
        <h2>Total: ${{ totalPrice.toFixed(2) }}</h2>
      </div>

      <form class="checkout-form" (ngSubmit)="submitOrder()">
        <h3>Checkout Information</h3>

        <div class="form-group">
          <label for="customerName">Full Name *</label>
          <input
            type="text"
            id="customerName"
            [(ngModel)]="customerName"
            (ngModelChange)="validateName()"
            name="customerName"
            required
            minlength="3"
            class="form-control"
            placeholder="Sam Fisher"
          />
          <small class="form-hint">Minimum 3 characters required</small>
          <small *ngIf="nameError" class="error-message">{{ nameError }}</small>
        </div>

        <div class="form-group">
          <label for="address">Address *</label>
          <textarea
            id="address"
            [(ngModel)]="address"
            (ngModelChange)="validateAddress()"
            name="address"
            required
            minlength="5"
            class="form-control"
            placeholder="Carl-wery-Straße 49, 81360, Munich"
            rows="3"
          ></textarea>
          <small class="form-hint"
            >Minimum 5 characters required. Example: Carl-wery-Straße 49, 81360, Munich</small
          >
          <small *ngIf="addressError" class="error-message">{{ addressError }}</small>
        </div>

        <div class="form-group">
          <label for="creditCard">Credit Card Number *</label>
          <input
            type="text"
            id="creditCard"
            [(ngModel)]="creditCard"
            (ngModelChange)="validateCreditCard()"
            name="creditCard"
            required
            minlength="16"
            maxlength="16"
            pattern="[0-9]{16}"
            class="form-control"
            placeholder="1234567890123456"
          />
          <small class="form-hint"
            >Numbers only. Exactly 16 digits required. Example: 1234567890123456</small
          >
          <small *ngIf="creditCardError" class="error-message">{{ creditCardError }}</small>
        </div>

        <button type="submit" class="btn btn-primary btn-large">Complete Purchase</button>
      </form>
    </div>
  </div>
</div>
